# MarketPrep Frontend

React + TypeScript + Vite PWA application for farmers market inventory predictions.

## Development

### Prerequisites

- Node.js 18+ and npm
- Backend API running on http://localhost:8000

### Setup

```bash
npm install
```

### Development Server

```bash
npm run dev
```

Runs the app on http://localhost:3000 with hot reload.

### Build for Production

```bash
npm run build
```

Outputs to `dist/` directory.

### Preview Production Build

```bash
npm run preview
```

## PWA Configuration

This app is configured as a Progressive Web App (PWA) with:

- **Offline Support**: Service worker caches assets and API responses
- **Installable**: Can be installed on mobile devices and desktops
- **Auto-Updates**: Service worker auto-updates when new version is deployed

### Generating PWA Icons

PWA icons should be placed in the `public/` directory:

- `pwa-64x64.png` - 64x64 favicon
- `pwa-192x192.png` - 192x192 Android icon
- `pwa-512x512.png` - 512x512 Android icon
- `maskable-icon-512x512.png` - 512x512 maskable icon (with safe zone)
- `apple-touch-icon.png` - 180x180 iOS icon

You can generate these from a source icon using tools like:
- [PWA Asset Generator](https://github.com/elegantapp/pwa-asset-generator)
- [Favicon Generator](https://realfavicongenerator.net/)

Example using pwa-asset-generator:
```bash
npx pwa-asset-generator source-icon.png ./public --icon-only
```

## Environment Variables

Create a `.env.local` file:

```env
VITE_API_BASE_URL=http://localhost:8000
```

## Architecture

### Key Technologies

- **React 18**: UI framework
- **TypeScript**: Type safety
- **Vite**: Build tool and dev server
- **Tailwind CSS**: Utility-first CSS
- **React Router**: Client-side routing
- **Axios**: HTTP client with interceptors
- **Vite PWA Plugin**: Service worker generation

### Project Structure

```
src/
├── components/     # Reusable UI components (Button, Card, Input)
├── contexts/       # React contexts (AuthContext)
├── layouts/        # Page layouts (AuthLayout, MainLayout)
├── lib/           # Utilities (api-client, utils)
├── pages/         # Route pages (Dashboard, Products, Recommendations)
├── App.tsx        # Root component
├── main.tsx       # Application entry point
├── router.tsx     # Route definitions
└── index.css      # Global styles with Tailwind
```

### Authentication Flow

1. User logs in via `/login`
2. JWT tokens stored in localStorage
3. API client auto-refreshes tokens on 401 errors
4. Protected routes redirect to login if unauthenticated

### API Client

The `apiClient` in `src/lib/api-client.ts` handles:
- Automatic token attachment
- Token refresh on 401 errors
- Request/response type safety
- Error handling

### Service Worker

The service worker (auto-generated by Vite PWA plugin):
- Caches static assets (JS, CSS, HTML, images)
- Network-first strategy for API calls (24h cache)
- Cache-first for fonts (1 year cache)
- Auto-updates when new version is detected

## Testing

```bash
npm test
```

Runs Vitest in watch mode.

## Linting

```bash
npm run lint
```

Runs ESLint with TypeScript support.

## Performance Optimization

The build is optimized with:

- **Code Splitting**: Vendor chunk (react, react-dom, react-router-dom) and API chunk (axios)
- **Tree Shaking**: Unused code removed
- **Minification**: JavaScript and CSS minified
- **Asset Optimization**: Images and fonts optimized
- **Lazy Loading**: Routes can be lazy-loaded with React.lazy()

## Browser Support

- Chrome/Edge 90+
- Firefox 88+
- Safari 14+
- iOS Safari 14+
- Android Chrome 90+

## License

Proprietary - All rights reserved
