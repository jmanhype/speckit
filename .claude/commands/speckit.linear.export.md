---
description: Export Spec Kit tasks to Linear as sub-issues linked to a parent issue
tools: ['mcp__linear__create_issue', 'mcp__linear__update_issue', 'mcp__linear__add_comment']
---

## User Input

```text
$ARGUMENTS
```

You **MUST** consider the user input before proceeding (if not empty).

## Outline

1. **Validate prerequisites**:
   - Run `.specify/scripts/bash/check-prerequisites.sh --json --require-tasks --include-tasks`
   - Parse FEATURE_DIR and verify tasks.md exists
   - Extract Linear ID from spec.md frontmatter (if imported via `/speckit.linear.import`)

2. **Determine parent Linear issue**:
   - If spec has `linear_id` in frontmatter, use that
   - If user provided issue ID in arguments, use that
   - Otherwise, ask: "Which Linear issue should these tasks be linked to? (e.g., TEAM-123)"

3. **Parse tasks.md**:
   - Extract all tasks with their metadata:
     - Task ID (e.g., T001)
     - Description
     - Priority (P1/P2/P3)
     - Phase (Setup/Tests/Core/Integration/Polish)
     - File paths affected
     - Dependencies
     - Parallel marker [P]

4. **Map priorities to Linear**:
   | Spec Kit | Linear Priority |
   |----------|-----------------|
   | P1 | Urgent (1) |
   | P2 | High (2) |
   | P3 | Medium (3) |

5. **Create sub-issues in Linear** for each task:
   - Use `mcp__linear__create_issue` for each task
   - Set parent issue relationship
   - Include in description:
     ```markdown
     ## Task Details
     - **Spec Kit ID**: T001
     - **Phase**: Core
     - **Files**: src/auth/login.ts, src/auth/session.ts
     - **Dependencies**: T000 (setup)

     ## Description
     [Task description from tasks.md]

     ---
     _Auto-generated by Spec Kit from specs/002-feature/tasks.md_
     ```

6. **Track created issues**:
   - Update tasks.md with Linear issue IDs:
     ```markdown
     - [x] T001: Implement login endpoint <!-- LINEAR:TEAM-124 -->
     ```
   - Create/update `.specify/linear-mapping.json`:
     ```json
     {
       "feature": "002-user-authentication",
       "parent_issue": "TEAM-123",
       "tasks": {
         "T001": "TEAM-124",
         "T002": "TEAM-125"
       },
       "exported_at": "2025-01-15T10:30:00Z"
     }
     ```

7. **Update parent issue**:
   - Add comment to parent Linear issue:
     ```
     ðŸ“‹ Spec Kit: Exported [N] tasks as sub-issues

     | Task | Issue | Priority | Phase |
     |------|-------|----------|-------|
     | T001 | TEAM-124 | P1 | Core |
     | T002 | TEAM-125 | P2 | Tests |

     Spec: specs/002-user-authentication/
     ```

8. **Output summary**:
   ```
   âœ… Exported 12 tasks to Linear

   Parent Issue: TEAM-123
   Sub-issues created: TEAM-124 through TEAM-135

   Task Mapping:
   - T001 â†’ TEAM-124 (Implement login endpoint)
   - T002 â†’ TEAM-125 (Add session management)
   ...

   Next steps:
   - View in Linear: https://linear.app/team/issue/TEAM-123
   - Run /speckit.linear.sync to keep status synchronized
   - Run /speckit.implement to begin implementation
   ```

## Error Handling

- **Linear MCP not configured**: Display setup instructions
- **Parent issue not found**: Verify issue ID exists
- **Permission denied**: Verify API key has write access
- **Partial failure**: Report which tasks succeeded/failed, offer retry

## Options

- `--dry-run`: Show what would be created without actually creating issues
- `--update`: Update existing Linear issues instead of creating new ones
- `--skip-existing`: Skip tasks that already have Linear IDs mapped

## Notes

- Tasks marked as completed `[x]` in tasks.md will be created with "Done" status
- Dependencies are noted in description but Linear doesn't support blocking relationships
- Use `/speckit.linear.sync` after implementation to update status
